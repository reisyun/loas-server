# Migration `20210211142441-add-history-id`

This migration has been generated by reisyun at 2/11/2021, 11:24:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "history" DROP CONSTRAINT "history_pkey",
ADD COLUMN "id" SERIAL,
ADD PRIMARY KEY ("id")

CREATE UNIQUE INDEX "history.userId_mediaId_unique" ON "history"("userId", "mediaId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210211132506-add-profile..20210211142441-add-history-id
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -60,8 +60,9 @@
   PLANNING
 }
 model History {
+  id          Int           @id @default(autoincrement())
   status      HistoryStatus
   repeat      Int?          @default(0)
   secret      Boolean?      @default(false)
   completedAt DateTime?     @default(now())
@@ -73,9 +74,9 @@
   userId  String
   media   Media  @relation(fields: [mediaId], references: [id])
   mediaId String
-  @@id([userId, mediaId])
+  @@unique([userId, mediaId])
   @@map(name: "history")
 }
 // Media
```


